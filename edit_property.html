{% extends "base.html" %}
{% block content %}

<section class="edit-property">
  <h2>Edit Property</h2>

  <form action="{{ url_for('edit_property', prop_id=property.id) }}" 
        method="POST" 
        enctype="multipart/form-data" 
        class="form-box">

    <label for="title">Title</label>
    <input type="text" name="title" id="title" 
           value="{{ property.title }}" required>

    <label for="description">Description</label>
    <input type="hidden" name="description" id="description-input">
    <div id="quill-editor"></div>


    <label for="price">Price (R.S)</label>
    <input type="number" name="price" id="price" step="0.01" 
           value="{{ property.price }}" required>

    <label for="location">Location</label>
    <input type="text" name="location" id="location" 
           value="{{ property.location }}" required>

    <label for="images">Upload New Images (optional)</label>
    <input type="file" name="images" id="images" 
           multiple accept="image/*">

    <button type="submit" class="btn">Update Property</button>
  </form>

  <div class="current-images">
    <h3>Current Images:</h3>
    {% set imgs = property.images | load_json %}
    {% if imgs and imgs|length > 0 %}
      <div class="image-thumbs">
        {% for img in imgs %}
          <img src="{{ url_for('static', filename='uploads/' ~ img) }}" 
               alt="Property Image">
        {% endfor %}
      </div>
    {% else %}
      <p>No images uploaded.</p>
    {% endif %}
  </div>
</section>


<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

<script>

  var quill = new Quill('#quill-editor', {
    theme: 'snow',
    placeholder: 'Write a detailed property description...',
    modules: {
      toolbar: [
        [{ 'header': [1, 2, 3, false] }],
        ['bold', 'italic', 'underline', 'strike'],
        [{ 'list': 'ordered' }, { 'list': 'bullet' }],
        [{ 'align': [] }],
        ['link', 'image'],
        ['clean']
      ]
    }
  });


  var form = document.querySelector('.sell-form');
  form.onsubmit = function() {
    document.querySelector('#description-input').value = quill.root.innerHTML;
  };
</script>

{% endblock %}
